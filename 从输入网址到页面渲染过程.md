##### 								从输入网址到页面加载完成

###### 1、浏览器地址输入url

###### 2、浏览器查找当前url是否存在缓存，并比较缓存是否过期

###### 3、DNS解析url对应的IP

###### 4、根据IP建立TCP连接(三次挥手)

###### 5、HTTP发起请求

###### 6、服务器处理请求，浏览器接收HTTP响应

###### 7、渲染页面，构建DOM树

###### 8、关闭TCP连接(四次挥手)

**一、URL**

- 常见的url如：***[http://www.baidu.com](http://www.baidu.com)***,这个域名由三部分组成：***协议名、域名、端口号***，这里的端口号默认，所以隐藏。
- 除以上url还会包含一些路径、查询、和其他片段。如：***http://www.tuicool.com/search?kw=%E4%***
- 常见的协议是***http协议***，除此之外还有***加密的Https协议、Ftp协议、File协议***
- url中间部分为域名，其他为端口号，http默认的是80，https默认的是443
- 同源策略、跨域问题.............

**二、缓存**

- http缓存有多种规则，根据是否需要重新向服务器发起请求分类，分为强制缓存、对比缓存
- ***强制缓存***判断http首部字段：cache-control，Expires
  - expires是一个绝对时间，即服务器时间。浏览器检查当前时间，还没到失效时间就直接使用缓存文件。但该方法存在一个问题：服务器时间与客户端时间可能不一致，所以该字段已经很少使用
  - cache-control中的max-age保存一个相对时间。例如Cache-Control:max-age= 48420，表示浏览器收到文件后，48420s内有效。如果同时存在cache-control和expires，浏览器总是优先使用cache-control
- ***对比缓存***通过http的last-modified，Etag字段进行判断
  - last-modified是第一次请求资源，服务器返回的字段，表示最后一次更新的时间。下一次浏览器请求资源时，就发送if-modified-since字段。服务器用本地last-modified时间与if-modified-since比较，如果不一致，则认为缓存过期并发送新的资源给浏览器；如果时间一致则发送304状态码，让浏览器继续使用缓存。
  - Etag：资源的实体标识，当资源内容更新时，Etag会改变。服务器会判断Etag是否发生变化，如果变化则返回新资源，否则返回304。
  - ![过程](./cache.png)



**三、DNS域名解析**

- 地址栏中输入的域名并不是最后资源所在的真实位置，域名只是一个与IP地址的一个映射。网络服务器的地址一串数字，为了方便记忆，则域名产生了。域名解析的过程其实就是将域名还原为ip地址的过程。
- 首先浏览器检查本地hosts文件是否有这个网址映射关系，如果有就调用这个ip地址映射，完成域名解析。
- 如果没找到则会查找本地DNS解析器缓存，如果查找到则返回
- 如果没找到则会查找本地DNS服务器，如果查找到则返回
- 最后迭代查询，按***根域服务器 ——顶级域 .cn —— 第二层域 hb.cn ——子域***，www.hb.cn的顺序找到IP地址。

**四、TCP连接**

- 在通过第一步的DNS域名解析后，获取到服务器的IP地址，在获取到IP地址后，便会开始建立第一次连接，这是由TCP协议完成的，主要通过三次握手进行连接。

  - 第一次握手：建立连接时，客户端发送syn包(syn = j)到服务器，并进入SYN_SENT状态，等待服务器确认

  - 第二次握手：服务器收到syn包，必须确认客户的syn(ack = j + 1),同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态

  - 第三次握手： 客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED（TCP连接成功）状态，完成三次握手。

  - 完成三次握手，客户端与服务器开始传送数据。

    ![tcp](./syn.png)

https://www.cnblogs.com/daijinxue/p/6640153.html